---
layout: post
title: Let a software control your keyboard and your mouse
published: true
---
Sikuli is a software that can control your mouse and your keyboard, and allows to do some automatic tasks.
It is useful when:
<ul>
	<li>those tasks cannot be done through an <a href="https://en.wikipedia.org/wiki/Application_programming_interface" target="_blank">API</a> (e.g. for flash websites),</li>
	<li>when you don’t want to learn an API (e.g.for a single work).</li>
</ul>

Sikuli works on all platforms and is available <a href="http://www.sikuli.org/" target="_blank">here</a>.
    


In the sequel, I show an example to capture images from Google Maps and make a map from them. The aim is to make a draw of <a href="http://www.ile-oleron-marennes.com/" target="_blank">a French island, l’île d’Oléron</a>.

**1 – Sikuli script.** I launch Google Maps and set my position where I want to begin the map.

<img src="../images/2014-9-11-Sikuli/map_example.png" alt="mapExample"/>

Then, I use Sikuli to make print screens and to click on the arrows, using the following code (the written language is Python).

    horizontal = 4
    vertical = 5
    for x in range(vertical):
        type(Key.PRINTSCREEN)
        for y in range(horizontal-1):     
            click(1409401927009); click(1409401927009)
            sleep(2)
            type(Key.PRINTSCREEN)
        for y in range(horizontal-1):
            click(1409401945762); click(1409401945762)        
        click(1409395141546); click(1409395141546); click(1409395141546)
        sleep(2)
    for x in range(vertical):
        click(1409404805602); click(1409404805602); click(1409404805602)


kfkfkffkfk (you are reading this??)

<pre>horizontal = 4
vertical = 5
for x in range(vertical):
    type(Key.PRINTSCREEN)
    for y in range(horizontal-1):     
        click(<a href="https://ahstat.files.wordpress.com/2014/09/1409401927009.png"><img class=" size-full wp-image-422 alignnone" src="https://ahstat.files.wordpress.com/2014/09/1409401927009.png" alt="1409401927009" width="15" height="17" /></a>); click(<a href="https://ahstat.files.wordpress.com/2014/09/1409401927009.png"><img class=" size-full wp-image-422 alignnone" src="https://ahstat.files.wordpress.com/2014/09/1409401927009.png" alt="1409401927009" width="15" height="17" /></a>)
        sleep(2)
        type(Key.PRINTSCREEN)
    for y in range(horizontal-1):
        click(<a href="https://ahstat.files.wordpress.com/2014/09/1409401945762.png"><img class="alignnone size-full wp-image-423" src="https://ahstat.files.wordpress.com/2014/09/1409401945762.png" alt="1409401945762" width="13" height="16" /></a>); click(<a href="https://ahstat.files.wordpress.com/2014/09/1409401945762.png"><img class="alignnone size-full wp-image-423" src="https://ahstat.files.wordpress.com/2014/09/1409401945762.png" alt="1409401945762" width="13" height="16" /></a>)        
    click(<a href="https://ahstat.files.wordpress.com/2014/09/1409395141546.png"><img class="alignnone size-full wp-image-421" src="https://ahstat.files.wordpress.com/2014/09/1409395141546.png" alt="1409395141546" width="18" height="14" /></a>); click(<a href="https://ahstat.files.wordpress.com/2014/09/1409395141546.png"><img class="alignnone size-full wp-image-421" src="https://ahstat.files.wordpress.com/2014/09/1409395141546.png" alt="1409395141546" width="18" height="14" /></a>); click(<a href="https://ahstat.files.wordpress.com/2014/09/1409395141546.png"><img class="alignnone size-full wp-image-421" src="https://ahstat.files.wordpress.com/2014/09/1409395141546.png" alt="1409395141546" width="18" height="14" /></a>)
    sleep(2)
for x in range(vertical):
    click(<a href="https://ahstat.files.wordpress.com/2014/09/1409404805602.png"><img class="alignnone size-full wp-image-424" src="https://ahstat.files.wordpress.com/2014/09/1409404805602.png" alt="1409404805602" width="13" height="12" /></a>); click(<a href="https://ahstat.files.wordpress.com/2014/09/1409404805602.png"><img class="alignnone size-full wp-image-424" src="https://ahstat.files.wordpress.com/2014/09/1409404805602.png" alt="1409404805602" width="13" height="12" /></a>); click(<a href="https://ahstat.files.wordpress.com/2014/09/1409404805602.png"><img class="alignnone size-full wp-image-424" src="https://ahstat.files.wordpress.com/2014/09/1409404805602.png" alt="1409404805602" width="13" height="12" /></a>)

</pre>


**2- Rename, crop and merge.** I take all the screens and rename them with R:

    my_list = list.files()
    file.rename(my_list, paste0(1:length(my_list), ".png"))

Then I cut the borders with Image Magick:

    mogrify -crop 768x867+75+65 *.png

Finally, I merge images with Image Magick:

    montage -mode concatenate -tile 4x5 *.png output.png

**3- Final output** (click to enlarge, 3Mo).

<a href="../images/2014-9-11-Sikuli/oleron1.png" target="_blank"><img src = "../images/2014-9-11-Sikuli/oleron1.png"></a>

Related contents:
<ul>
	<li>the <a href="http://www.sikuli.org/" target="_blank">webpage of the Sikuli project</a>.</li>
	<li>the <a href="../images/2014-9-11-Sikuli/oleron2.png" target="_blank">Oléron map in hi-res</a> (10Mo file).</li>
</ul>